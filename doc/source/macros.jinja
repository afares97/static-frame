{# api_detail /////////////////////////////////////////////////////////////// #}
{% macro api_detail(name, cls, ig, ig_tag, frame_items, examples_defined) -%}

{# `name`: str class name, `cls`: container class, `ig`: full interface group str, `ig_tag`: linkable interface group str, `frame_items`: sub-frame for group #}


.. _api-detail-{{ name }}-{{ ig_tag }}:

{{ name }}: {{ ig }}
================================================================================

Overview: :ref:`api-overview-{{ name }}-{{ ig_tag }}`

{% for signature, row in frame_items.iter_tuple_items(axis=1) -%}

{# anchor for linking from overview #}
.. _api-sig-{{ name }}-{{ row.signature_no_args }}:


{% if row.use_signature and signature.startswith('[') %}

.. py:method:: {{ name }}{{ signature }}  {# NOTE: no dot! #}

{% elif row.use_signature and signature.startswith('interface') %}

.. py:attribute:: {{ name }}.{{ signature }}

    {{ row.doc }}

{% elif row.use_signature and not row.is_attr %}

.. py:method:: {{ name }}.{{ signature }}
    :noindex:

{% elif row.use_signature and row.is_attr %}

.. py:attribute:: {{ name }}.{{ signature }}
    :noindex:

{% elif ig == 'Attribute' or signature == 'values' or row.is_attr %}

.. autoattribute:: static_frame.{{ row.reference }}
    :noindex:

{% else %}

.. automethod:: static_frame.{{ row.reference }}
    :noindex:

{% endif %}


{# if a signature has been used, then we need to augment with doc with reference #}
{% if row.use_signature %}

    {% if row.reference and row.is_attr %}

    .. autoattribute:: static_frame.{{ row.reference }}
        :noindex:

    {% elif row.reference %}

    .. automethod:: static_frame.{{ row.reference }}
        :noindex:

    {% endif %}

{% endif %}


{# if delegate_reference is defined, always include it #}
{% if row.delegate_reference %}

    {% if row.delegate_is_attr %}

    .. autoattribute:: static_frame.{{ row.delegate_reference }}
        :noindex:

    {% else %}

    .. automethod:: static_frame.{{ row.delegate_reference }}
        :noindex:

    {% endif %}

{% endif %}


{# example ////////////////////////////////////////////////////////////////// #}

{% if name + '-' + row.signature_no_args in examples_defined %}

    .. literalinclude:: ../examples.txt
       :language: python
       :start-after: start_{{ name }}-{{ row.signature_no_args }}
       :end-before: end_{{ name }}-{{ row.signature_no_args }}

{% endif %}

{% endfor %}

{# :ref:`api-detail-{{ name }}`: {% for group_xref, _ in frame_items %}:ref:`{{ group_xref }}<api-detail-{{ name }}-{{ group_xref }}>`{{ " | " if not loop.last }}{% endfor %} #}

{%- endmacro %}




{# api_overview ///////////////////////////////////////////////////////////// #}
{% macro api_overview(name, cls, ig, ig_tag, frame_items, examples_defined) -%}
{# `name`: str class name, `cls`: container class, `ig`: full interface group str, `ig_tag`: linkable interface group str, `frame_items`: sub-frame for group #}


.. _api-overview-{{ name }}-{{ ig_tag }}:

{{ name }}: {{ ig }}
================================================================================


Detail: :ref:`api-detail-{{ name }}-{{ ig_tag }}`

.. csv-table::
    :header-rows: 0

    {% for signature, row in frame_items.iter_tuple_items(axis=1) -%}
        {% if signature.startswith('[') -%}
        :ref:`Detail<api-sig-{{ name }}-{{ row.signature_no_args }}>`, ":obj:`{{name}}{{signature}}`", "{{row.doc}}"
        {% else -%}
        :ref:`Detail<api-sig-{{ name }}-{{ row.signature_no_args }}>`, ":obj:`{{name}}.{{signature}}`", "{{row.doc}}"
        {% endif -%}
    {% endfor %}

{# :ref:`api-overview-{{ name }}`: {% for group_xref, _ in frame_items %}:ref:`{{ group_xref }}<api-overview-{{ name }}-{{ group_xref }}>`{{ " | " if not loop.last }}{% endfor %} #}

{# {% endfor %} #}
{%- endmacro %}